!function(e){"use strict";function r(){function r(){d.map=L.map("map",{minZoom:2,scrollWheelZoom:!1}).setView([37.5333,-77.4667],2),new L.Hash(d.map),g.push(L.tileLayer("http://{s}.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}.png",{attribution:'&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'})),g[g.length-1].addTo(d.map),d.layerMenu.on("orderChanged",function(e){n(),e.caller.order.forEach(function(e){l(e)})}),d.layerMenu.on("color-change",function(e){("pointlayer"===e.caller.list||"hexlayer"===e.caller.list)&&(f[e.caller.id].colorScale().range([e.caller.color,e.caller.color]),f[e.caller.id]._redraw()),"hulllayer"===e.caller.list&&f[e.caller.id]._featureGroup.getLayers().forEach(function(r){var o;r._icon&&(o=r._icon.querySelector(".innerMarker"),o&&(o.style.backgroundColor=e.caller.color)),r._group&&r._group.getLayers().forEach(function(r){r._path&&r.setStyle({color:e.caller.color})})})}),document.querySelector("#hexagon-radius").addEventListener("change",function(e){d.map.eachLayer(function(r){if(r.options.__sHexLayer===!0){r.options.radius=+e.target.value,r.options.radiusRange=[1,+e.target.value];var o=r._data;r.initialize(r.options),r.data(o)}})})}function o(e){var r=s.getLayerNode(e);d.utils.append(r,'<div id="floatingCirclesG" class="loading"><div class="f_circleG" id="frotateG_01"></div><div class="f_circleG" id="frotateG_02"></div><div class="f_circleG" id="frotateG_03"></div><div class="f_circleG" id="frotateG_04"></div><div class="f_circleG" id="frotateG_05"></div><div class="f_circleG" id="frotateG_06"></div><div class="f_circleG" id="frotateG_07"></div><div class="f_circleG" id="frotateG_08"></div></div>')}function t(e){var r=s.getLayerNode(e),o=r.querySelector(".loading");o&&o.parentNode.removeChild(o)}function n(){d.map.eachLayer(function(e){d.map.removeLayer(e)}),g=[],f={}}function a(){var r,n=document.querySelector("#legend-layer-menu-min"),a=document.querySelector("#legend-layer-menu .close-button");try{r=JSON.parse(decodeURIComponent(LZString.decompressFromUTF16(d.statefulQueryString.get("state"))))}catch(i){r=null}s=new e.LegendLayerMenu("#legend-layer-menu",{menuState:r}),d.layerMenu=s,r=s.getMenuState(),r&&r.forEach(function(e){o(e),d.showLayer(e,function(){t(e)})}),s.on("layerAdded",function(e){var r=e.caller,n=s.getMenuState();o(r),d.showLayer(r,function(){t(r)}),n=n.map(function(e){return delete e.id,delete e.element,e.uri=e.uri.replace(/%22/g,"'"),e}),d.statefulQueryString.set("state",encodeURIComponent(LZString.compressToUTF16(JSON.stringify(n))))}),n.addEventListener("click",function(){s.rootNode.classList.contains("open")?s.rootNode.classList.remove("open"):s.rootNode.classList.add("open")},!1),a.addEventListener("click",function(){s.rootNode.classList.remove("open")},!1)}function i(){d.statefulQueryString=new e.StatefulQueryString}function c(e,r){"object"==typeof f[e.id]&&"raster"!==e.list&&(d.map.removeLayer(f[e.id]),delete f[e.id]),f[e.id]=p[e.list](r,e),d.map.addLayer(f[e.id])}function l(r,o){return y[r.id]||"raster"===r.list?void c(r,y[r.id]):(new e.EcoengineClient).requestRecursive(r.uri.replace(/'/g,'"'),function(e){y[r.id]=e,c(r,e),d.fire("showLayer"),"function"==typeof o&&o()},function(e){c(r,e),d.fire("showLayerProgress")})}function u(e){d.map.removeLayer(f[e]),d.fire("showLayer",{layer:f[e]})}var s,d=this,f={},y={},p={pointlayer:function(e,r){var o=new L.HexbinLayer({radiusRange:[1,1],radius:1,opacity:1,colorRange:[r.color,r.color]}).addTo(d.map);return o.data(e.filter(function(e){return"object"==typeof e.geometry&&null!==e.geometry}).map(function(e){return e.geometry.coordinates})),o},hulllayer:function(e,r){var o=new L.MarkerClusterGroup({polygonOptions:{color:r.color,stroke:!1,opacity:.7}});return e.forEach(function(e){e.geometry&&o.addLayer(L.marker([e.geometry.coordinates[1],e.geometry.coordinates[0]],{icon:L.divIcon({className:"point-feature-icon point-feature-icon-"+r.color})}))}),o},hexlayer:function(e,r){var o=new L.HexbinLayer({radiusRange:[1,document.querySelector("#hexagon-radius").value],radius:document.querySelector("#hexagon-radius").value,opacity:1,colorRange:[r.color,r.color]}).addTo(d.map);return o.hexMouseOver(function(e){console.log(e)}),o.hexMouseOut(function(){}),o.hexClick(function(){}),o.data(e.filter(function(e){return"object"==typeof e.geometry&&null!==e.geometry}).map(function(e){return e.geometry.coordinates})),o.options.__sHexLayer=!0,o},raster:function(e,r){return g.push(L.tileLayer(r.uri,{transparent:!0,unloadInvisibleTiles:!0})),g[g.length-1].addTo(d.map),g[g.length-1]}},g=[];return d.utils=STPX.browsersugar.mix({}),d.showLayer=l,d.hideLayer=u,d.showMenuItemLoadState=o,d.hideMenuItemLoadState=t,i(),a(),r(),d}new(STPX.samesies.extend(r))}(window.STMN);
//# sourceMappingURL=index.min.js.map